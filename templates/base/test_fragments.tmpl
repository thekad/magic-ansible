{{- define "network_setup" -}}
- name: Create test network
  google.cloud.gcp_compute_network:
    name: "{{`{{ resource_name }}`}}"
    state: present
    auto_create_subnetworks: true
    project: "{{`{{ gcp_project }}`}}"
    auth_kind: "{{`{{ gcp_cred_kind }}`}}"
    service_account_file: "{{`{{ gcp_cred_file }}`}}"
  register: _network
{{- end -}}
{{- define "network_teardown" -}}
- name: Destroy test network
  google.cloud.gcp_compute_network:
    name: "{{`{{ resource_name }}`}}"
    state: absent
    project: "{{`{{ gcp_project }}`}}"
    auth_kind: "{{`{{ gcp_cred_kind }}`}}"
    service_account_file: "{{`{{ gcp_cred_file }}`}}"
{{- end -}}