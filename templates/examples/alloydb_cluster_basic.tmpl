- name: Create a basic alloydb cluster
  google.cloud.gcp_alloydb_cluster:
    cluster_id: "{{`{{ resource_name }}`}}"
    state: present
    location: us-central1
    network_config:
      network: "projects/{{`{{ gcp_project }}`}}/global/networks/default"
    initial_user:
      user: pgadmin
      password: testpassword
    labels:
      env: dev
    project: "{{`{{ gcp_project }}`}}"
    auth_kind: "{{`{{ gcp_cred_kind }}`}}"
    service_account_file: "{{`{{ gcp_cred_file }}`}}"

- name: Delete cluster
  google.cloud.gcp_alloydb_cluster:
    cluster_id: "{{`{{ resource_name }}`}}"
    state: absent
    location: us-central1
    network_config:
      network: "projects/{{`{{ gcp_project }}`}}/global/networks/default"
    project: "{{`{{ gcp_project }}`}}"
    auth_kind: "{{`{{ gcp_cred_kind }}`}}"
    service_account_file: "{{`{{ gcp_cred_file }}`}}"
